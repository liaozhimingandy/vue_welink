{"version":3,"file":"js/593.1c13f872.js","mappings":"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","sources":["webpack://web/./src/const/const.js","webpack://web/./src/components/ImageUpload.vue","webpack://web/./src/components/ImageUpload.vue?68da","webpack://web/./src/components/PictureList.vue","webpack://web/./src/components/PictureList.vue?d93d","webpack://web/./src/components/MomentDetail.vue","webpack://web/./src/components/MomentDetail.vue?9b10","webpack://web/./src/view/HomeView.vue","webpack://web/./src/view/HomeView.vue?a22c"],"sourcesContent":["/*\r\n* 全局常量配置区\r\n*\r\n* */\r\n\r\n// 动态刷新间隔, 2分钟\r\nconst refresh = 120000;\r\n\r\n// 接口地址列表\r\nconst apis = {\r\n    moment_lasted: \"/api/moment/moments/lasted/\",\r\n    moment_push: \"/api/moment/moments/\",\r\n    authorize: '/api/v2/user/oauth/authorize/'\r\n}\r\n\r\nexport default { apis, refresh };\r\n","<template>\r\n  <el-upload\r\n      :class=\"{ hide: hideUpload }\"\r\n      name=\"image\"\r\n      :action= \"uploadUrl\"\r\n      :headers=\"headerObj\"\r\n      list-type=\"picture-card\"\r\n      :limit=\"upload_image_limit\"\r\n      :file-list=\"list_images\"\r\n      :show-file-list=\"true\"\r\n      :on-change=\"fileChange\"\r\n      :auto-upload=\"true\"\r\n      :on-progress=\"handle_progress_images_upload\"\r\n      accept=\"image/*\"\r\n      :on-success=\"handle_upload_success\"\r\n      multiple\r\n  >\r\n    <el-icon>\r\n      <Plus/>\r\n    </el-icon>\r\n    <template #file=\"{ file }\">\r\n      <div>\r\n        <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt/>\r\n        <span class=\"el-upload-list__item-actions\">\r\n            <span class=\"el-upload-list__item-preview\" @click=\"handlePictureCardPreview(file)\">\r\n              <el-icon>\r\n                <zoom-in/>\r\n              </el-icon>\r\n            </span>\r\n            <span class=\"el-upload-list__item-delete\" @click=\"handleRemove(file)\">\r\n              <el-icon>\r\n                <Delete/>\r\n              </el-icon>\r\n            </span>\r\n          </span>\r\n        <el-progress type=\"circle\" :percentage=\"percentage\" :color=\"colors\" class=\"progress\"\r\n                     style=\"display:none;\"/>\r\n      </div>\r\n    </template>\r\n    <template #tip>\r\n      <div class=\"el-upload__tip\">最多上传{{upload_image_limit}}张图片,且单张图片大小不能超过10MB</div>\r\n    </template>\r\n  </el-upload>\r\n    <el-dialog v-model=\"dialogVisible\">\r\n      <img :src=\"dialogImageUrl\" alt=\"Preview Image\" style=\"max-width: 100%\"/>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, defineExpose } from 'vue'\r\nimport { Delete, Plus, ZoomIn } from \"@element-plus/icons-vue\";\r\n\r\n// import { ElMessage } from \"element-plus\";\r\nconst upload_image_limit = ref(9); //图片限制数量\r\nconst dialogImageUrl = ref(\"\"); // 预览图url\r\nconst dialogVisible = ref(false); // 预览弹窗\r\nconst hideUpload = ref(false); // 是否隐藏上传按钮\r\nconst list_images = ref([]); // 文件列表\r\nconst percentage = ref(90)   //上传进度\r\nconst colors = [                  // 上传颜色进度条\r\n  { color: '#f56c6c', percentage: 20 },\r\n  { color: '#e6a23c', percentage: 40 },\r\n  { color: '#5cb87a', percentage: 60 },\r\n  { color: '#1989fa', percentage: 80 },\r\n  { color: '#6f7ad3', percentage: 100 },\r\n]\r\n\r\n // 上传图片的地址\r\nconst uploadUrl=\"http://127.0.0.1:8000/api/moment/image/upload/\";\r\n// 设置图片上传组件的headers请求头对象\r\nconst headerObj = {\r\n  Authorization: 'Bearer ' + localStorage.getItem('access_token')\r\n};\r\n\r\n// 更新上传加号按钮显示状态\r\nfunction updateUploadShown() {\r\n  hideUpload.value = list_images.value.length === upload_image_limit.value;\r\n}\r\n// 文件改变\r\nfunction fileChange(file, resfileList) {\r\n  list_images.value = resfileList;\r\n  updateUploadShown();\r\n}\r\n// 移除图片\r\nconst handleRemove = (file) => {\r\n  const list = list_images.value;\r\n  for (const i in list) {\r\n    if (list[i].uid === file.uid) {\r\n      list.splice(i, 1);\r\n    }\r\n  }\r\n  list_images.value = list;\r\n  updateUploadShown();\r\n};\r\n// 预览图片\r\nconst handlePictureCardPreview = (file) => {\r\n  dialogImageUrl.value = file.url;\r\n  dialogVisible.value = true;\r\n};\r\n\r\n//图片上传进度\r\nconst handle_progress_images_upload = (file) => {\r\n  console.info(file)\r\n};\r\n\r\n//上传成功\r\nconst handle_upload_success = (response) =>{\r\n  console.log(response)\r\n}\r\n\r\ndefineExpose({list_images, })\r\n</script>\r\n\r\n<style scoped>\r\n/*控制上传控件大小*/\r\n:deep(.el-upload--picture-card){\r\n  margin-top: 4%;\r\n  height:80px;\r\n  width:80px;\r\n  line-height: 80px;\r\n}\r\n/*控制缩略图控件大小*/\r\n:deep(.el-upload-list__item){\r\n  margin-top: 4%;\r\n  height:80px;\r\n  width:80px;\r\n  line-height: 80px;\r\n}\r\n/*控制超过指定数量时隐藏上传按钮*/\r\n.hide >>> .el-upload--picture-card {\r\n  display: none;\r\n}\r\n\r\n/* 内容居中 */\r\n.progress{\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n</style>","import script from \"./ImageUpload.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ImageUpload.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ImageUpload.vue?vue&type=style&index=0&id=14bac546&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\pycharm\\\\welink\\\\web\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-14bac546\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"SongList\">\r\n    <div class=\"covers\" :style=\"{ display: obj.MinDisplay, }\">\r\n      <div class=\"cover\" v-for=\"(image, index) in images\" :key='index'>\r\n        <el-image\r\n            style=\"width: 97%; height:200px\" class=\"min\"\r\n            :src=\"image\"\r\n            :preview-src-list=\"list_picture\"\r\n            :initial-index=\"index\"\r\n            fit=\"cover\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed } from \"vue\";\r\nimport {defineProps} from \"vue\";\r\n\r\nconst props = defineProps(['images'])\r\nconst obj = reactive({\r\n  \"MinDisplay\": ref(\"flex\"),\r\n  \"ShowIndex\": ref(0),\r\n  \"display\": ref(\"none\")\r\n})\r\n\r\n// 显示的图片列表\r\nconst list_picture =  computed(() => {\r\n  let tmp_list_picture = []\r\n  let item;\r\n  for(item in props.images){\r\n    tmp_list_picture.push(props.images[item])\r\n  }\r\n  return tmp_list_picture\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n   .SongList{\r\n        width: 90%;\r\n    }\r\n    .covers{\r\n        display: flex;\r\n        justify-content: left;\r\n        flex-wrap: wrap;\r\n    }\r\n    .cover{\r\n        display: flex;\r\n        justify-content: center;\r\n        width: 33.3%;\r\n        margin: 6px 0;\r\n    }\r\n    .min{\r\n        border-radius: 8px;\r\n        cursor: zoom-in;\r\n    }\r\n</style>","import script from \"./PictureList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PictureList.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PictureList.vue?vue&type=style&index=0&id=21e86ac8&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\pycharm\\\\welink\\\\web\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-21e86ac8\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"radius\">\r\n    <el-row align=\"middle\" style=\"padding: 3px 3px;\">\r\n      <el-col :xs=\"5\" :sm=\"3\" :md=\"3\" :lg=\"2\" :xl=\"1\">\r\n        <el-avatar :size=\"60\">\r\n          <img src=\"\"/>\r\n        </el-avatar>\r\n      </el-col>\r\n      <el-col style=\"text-align: left;\" :xs=\"19\" :sm=\"21\" :md=\"21\" :lg=\"22\" :xl=\"23\" >\r\n        <el-row>{{ (item.nick_name == '' || item.nick_name == null) ?  item.username : item.nick_name}}•{{ timestampFormat(Date.parse(item.gmt_created)/1000) }}{{ (item.from_ip == null || item.from_ip == '') ? \"\": \"•\"+item.from_ip }}</el-row>\r\n        <el-row>@{{ item.username }}</el-row>\r\n      </el-col>\r\n    </el-row>\r\n    <el-row style=\"text-align: left; padding-left: 63px; background-color: #e9ebee; \">\r\n      <el-col>{{ item.moment }}</el-col>\r\n      <el-col>\r\n         <PitureList :images=\"item.images\"></PitureList>\r\n      </el-col>\r\n    </el-row>\r\n    <el-row style=\"text-align: left; padding-left: 63px; padding-top: 3px; \">\r\n      {{ item.loc }}\r\n    </el-row>\r\n    <el-divider style=\"margin:10px 0;\"></el-divider>\r\n    <el-row>\r\n      <el-col>\r\n        <el-button type=\"danger\" text :icon=\"StarFilled\" @click=\"update_liked(item)\">赞({{ item.liked }})</el-button>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { defineProps } from \"vue\";\r\nimport { StarFilled } from '@element-plus/icons-vue'\r\nimport PitureList from \"../components/PictureList.vue\"\r\ndefineProps(['item'])\r\n\r\nconst timestampFormat = (timestamp) => {\r\n  function zeroize(num) {\r\n        return (String(num).length == 1 ? '0' : '') + num;\r\n    }\r\n    const curTimestamp = parseInt((new Date().getTime() / 1000).toString()); //当前时间戳\r\n    const timestampDiff = curTimestamp - timestamp; // 参数时间戳与当前时间戳相差秒数\r\n    const curDate = new Date(curTimestamp * 1000); // 当前时间日期对象\r\n    const tmDate = new Date(timestamp * 1000); // 参数时间戳转换成的日期对象\r\n    const Y = tmDate.getFullYear();\r\n    const m = tmDate.getMonth() + 1;\r\n    const d = tmDate.getDate();\r\n    const H = tmDate.getHours();\r\n    const i = tmDate.getMinutes();\r\n    //const s = tmDate.getSeconds();\r\n    if (timestampDiff < 60) { // 一分钟以内\r\n        return \"刚刚\";\r\n    } else if (timestampDiff < 3600) { // 一小时前之内\r\n        return Math.floor(timestampDiff / 60) + \"分钟前\";\r\n    } else if (curDate.getFullYear() == Y && curDate.getMonth() + 1 == m && curDate.getDate() == d) {\r\n        return '今天' + zeroize(H) + ':' + zeroize(i);\r\n    } else {\r\n        var newDate = new Date((curTimestamp - 86400) * 1000); // 参数中的时间戳加一天转换成的日期对象\r\n        if (newDate.getFullYear() == Y && newDate.getMonth() + 1 == m && newDate.getDate() == d) {\r\n            return '昨天' + zeroize(H) + ':' + zeroize(i);\r\n        } else if (curDate.getFullYear() == Y) {\r\n            return zeroize(m) + '月' + zeroize(d) + '日 ' + zeroize(H) + ':' + zeroize(i);\r\n        } else {\r\n            return Y + '年' + zeroize(m) + '月' + zeroize(d) + '日 ' + zeroize(H) + ':' + zeroize(i);\r\n        }\r\n    }\r\n}\r\n\r\n// 更新赞数\r\nconst update_liked = (item)=>{\r\n  item.liked = item.liked + 1;\r\n};\r\n\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.radius {\r\n  border: 1px solid red;\r\n  border-radius: 6px;\r\n  margin-top: 6px;\r\n  background-color: white;\r\n}\r\n</style>","import script from \"./MomentDetail.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MomentDetail.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./MomentDetail.vue?vue&type=style&index=0&id=97523346&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\pycharm\\\\welink\\\\web\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-97523346\"]])\n\nexport default __exports__","<template>\r\n  <el-container>\r\n    <el-header style=\"padding: 0\">\r\n      <el-menu\r\n          :default-active=\"activeIndex\"\r\n          class=\"el-menu-demo\"\r\n          mode=\"horizontal\"\r\n          :ellipsis=\"false\"\r\n      >\r\n        <el-menu-item disabled>logo</el-menu-item>\r\n        <div class=\"flex-grow\"/>\r\n        <el-menu-item index=\"1\">首页</el-menu-item>\r\n        <el-sub-menu index=\"2\">\r\n          <template #title>更多</template>\r\n          <el-menu-item index=\"2-1\"><a href=\"mailto:liaozhimingandy@qq.com\">意见反馈(使用邮件反馈)</a></el-menu-item>\r\n          <el-menu-item index=\"2-2\"><a href=\"/privacy\">关于隐私</a></el-menu-item>\r\n          <el-menu-item index=\"2-3\"><el-button link @click=\"logout\">退出登录</el-button></el-menu-item>\r\n        </el-sub-menu>\r\n      </el-menu>\r\n    </el-header>\r\n    <el-container>\r\n      <el-aside class=\"hidden-md-and-down\">\r\n        <el-card shadow=\"hover\">首页</el-card>\r\n      </el-aside>\r\n      <el-main style=\"padding-top: 0\">\r\n        <!--          新鲜事编辑-->\r\n        <el-card shadow=\"hover\">\r\n          <el-input v-model=\"obj.data\" placeholder=\"分享你的新鲜事给大家吧\" :autosize=\"{ minRows: 2, maxRows: 6 }\"\r\n                    type=\"textarea\" maxlength=\"512\" size=\"large\" show-word-limit clearable/>\r\n<!--          图片上传-->\r\n          <div v-show=\"is_upload_images\">\r\n            <ImageUpload ref=\"image_upload\"/>\r\n            <el-divider></el-divider>\r\n          </div>\r\n          <div class=\"bottom\">\r\n            <el-tooltip effect=\"dark\" content=\"轻触来上传图片\" placement=\"top\">\r\n              <span>\r\n              <el-button size=\"large\" link @click=\"is_upload_images=!is_upload_images\" id=\"btn-images-upload\">\r\n              <el-icon :size=\"28\"><Picture /></el-icon>\r\n             </el-button>\r\n              </span>\r\n            </el-tooltip>\r\n            <el-button :type=\"obj['btn_type']\" :icon=\"Promotion\" @click=\"send\" :disabled=\"calculate_is_disabled()\">发布</el-button>\r\n          </div>\r\n        </el-card>\r\n        <!--          tmp -->\r\n          <el-alert title=\"目前为开发阶段,所有数据均保存为你的本地,刷新浏览器即消失,欢迎使用!\" type=\"warning\" effect=\"dark\" :closable=\"false\"\r\n          style=\"margin-top: 6px;\"/>\r\n        <!--          新鲜事-->\r\n        <MomentsDetail v-for=\"(item, index) in items.data\" :key=\"index\" :item=\"item\"/>\r\n      </el-main>\r\n      <el-aside class=\"hidden-md-and-down\" style=\"padding-right: 8px\">\r\n        <el-card shadow=\"hover\">{{ obj.currentDate }}</el-card>\r\n        <el-card shadow=\"hover\">人人都是产品经理,请把你想要的功能告诉我们!</el-card>\r\n        <div style=\"margin-top: 8px; color:#6c757d; font-size: 12px;\">\r\n          <span>版本号: 0.1</span>\r\n        </div>\r\n      </el-aside>\r\n    </el-container>\r\n  </el-container>\r\n  <el-backtop :right=\"100\" :bottom=\"100\" ></el-backtop>\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport { inject, reactive, onMounted, onBeforeUnmount, ref } from 'vue'\r\nimport { Promotion, Picture } from '@element-plus/icons-vue'\r\nimport { ElNotification } from 'element-plus'\r\nimport 'element-plus/theme-chalk/display.css'\r\n\r\nimport MomentsDetail from '../components/MomentDetail'\r\nimport ImageUpload from '../components/ImageUpload'\r\nimport $const from '../const/const'\r\nimport router from \"@/router\";\r\n\r\nconst obj = reactive({\r\n  \"data\": '',\r\n  \"currentDate\": \"\",\r\n  \"btn_type\": \"danger\",\r\n  \"timer\": null\r\n})\r\nconst items = reactive({\"data\": []})\r\n // const proxy = getCurrentInstance();\r\n // const { $axios } = proxy.appContext.config.globalProperties;\r\nconst $axios = inject(\"$axios\");\r\nconst activeIndex = ref('1')\r\nconst is_upload_images = ref(false)\r\nconst image_upload = ref() // 图片上传组件\r\n\r\nfunction calculate_is_disabled() {\r\n  // console.info(data.value)\r\n  return obj.data.trim().length === 0 ? true : false\r\n}\r\n\r\n// 发送事件\r\nconst send = async () => {\r\n   // 调整按钮的可用状态\r\n  // const el = document.getElementById(\"btn\")\r\n  obj.btn_type = \"success\";\r\n\r\n  // 上传图片列表\r\n  let list_image_upload = [];\r\n  if(is_upload_images.value){\r\n    image_upload.value.list_images.forEach(function(item){\r\n      list_image_upload.push(item.response.image_path)\r\n    });\r\n  }\r\n  // 动态数据\r\n  let moment = {\r\n    \"moment\": obj.data,\r\n    \"gmt_created\": new Date(),\r\n    \"user_name\": \"anonymous\",\r\n    \"nick_name\": localStorage.getItem('nick_name'),\r\n    \"loc\": \"中国\",\r\n    \"from_device\": \"iphone 13\",\r\n    \"from_ip\": \"\",\r\n    \"images\": list_image_upload,\r\n    \"liked\": 0,\r\n    \"right_status\": 0,\r\n    \"content_class\": 0,\r\n    \"uid\": localStorage.getItem('uid')\r\n  }\r\n\r\n  await $axios({ url: $const.apis.moment_push, method: 'post', data: moment}).then((resp) => {\r\n      obj.currentDate = resp.gmt_created;\r\n    }).catch((err) => {\r\n      // 错误内容\r\n      console.log(err.response.data)\r\n      console.log(err.code)\r\n    });\r\n\r\n  // 重新赋值图片地址\r\n    if(is_upload_images.value){\r\n      list_image_upload = [];\r\n    image_upload.value.list_images.forEach(function(item){\r\n      list_image_upload.push(item.response.url)\r\n    });\r\n  }\r\n  moment.images = list_image_upload;\r\n   // 添加内容到第一个列表中\r\n  items.data.unshift(moment)\r\n  // 清除编辑框内容\r\n  obj.data = \"\"\r\n  // 调整按钮的状态\r\n  obj.btn_type = \"danger\";\r\n  if(is_upload_images.value) {\r\n    // 清空图片列表\r\n    image_upload.value.list_images = [];\r\n    // 图片上传组件隐藏\r\n    is_upload_images.value = false;\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  // 请求后台加载动态\r\n  load_moments()\r\n  // 定时请求后台数据\r\n   obj.timer = setInterval(function () {\r\n    //执行内容\r\n    load_moments()\r\n  }, $const.refresh);\r\n  obj.timer = setInterval(function () {\r\n    //执行内容\r\n    obj.currentDate = format_datatime(new Date())\r\n  }, 800);\r\n})\r\n\r\nonBeforeUnmount(()=>{\r\n  for(let item in obj.timer){\r\n    clearInterval(item)\r\n}\r\n})\r\n\r\n// 请求后台加载数据\r\nconst load_moments = async () => {\r\n  await $axios({\r\n    url: $const.apis.moment_lasted,\r\n    method: 'get',\r\n    data: null\r\n  }).then((resp) => {\r\n    // 长度为0,直接跳过\r\n    if(resp.length === 0){\r\n       return;\r\n    }\r\n    let moments = resp;\r\n    moments.sort(function (a, b) {\r\n      let x = a[\"mid\"];\r\n      let y = b[\"mid\"];\r\n      return ((x < y) ? -1 : (x > y) ? 1 : 0)\r\n    });\r\n    moments.forEach(function (item) {\r\n      items.data.unshift(item)\r\n    });\r\n    // console.info(removalDuplicate(items.data, 'moment_id'))\r\n    // 排重\r\n    items.data = removalDuplicate(items.data, 'mid')\r\n\r\n    //  加载成功后给提示\r\n    ElNotification({\r\n      title: '动态更新通知',\r\n      message: \"共加载\"+moments.length+\"条数据\",\r\n      type: 'success',\r\n      position: 'bottom-right'\r\n    })\r\n  }).catch((err) => {\r\n    console.log(err.code)\r\n  })\r\n}\r\n\r\n//【js去掉集合List重复项】\r\n\t//删除集合重复项\r\n\t//*dataList* 将要去重集合\r\n\t//*byName* 去重依据属性名称\r\nfunction removalDuplicate(dataList, byName) {\r\n\t\tvar result = [];\r\n\t\tvar tem = {};\r\n\t\tfor (var i = 0; i < dataList.length; i++) {\r\n\t\t\tif (!tem[dataList[i][byName]]) {\r\n\t\t\t\tresult.push(dataList[i]);\r\n\t\t\t\ttem[dataList[i][byName]] = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n// 当前时间格式化\r\nconst format_datatime = (timeStamp) =>{\r\n      let year = new Date(timeStamp).getFullYear();\r\n      let month =new Date(timeStamp).getMonth() + 1 < 10? \"0\" + (new Date(timeStamp).getMonth() + 1): new Date(timeStamp).getMonth() + 1;\r\n      let date =new Date(timeStamp).getDate() < 10? \"0\" + new Date(timeStamp).getDate(): new Date(timeStamp).getDate();\r\n      let hh =new Date(timeStamp).getHours() < 10? \"0\" + new Date(timeStamp).getHours(): new Date(timeStamp).getHours();\r\n      let mm =new Date(timeStamp).getMinutes() < 10? \"0\" + new Date(timeStamp).getMinutes(): new Date(timeStamp).getMinutes();\r\n      let ss =new Date(timeStamp).getSeconds() < 10? \"0\" + new Date(timeStamp).getSeconds(): new Date(timeStamp).getSeconds();\r\n      var d = new Date(timeStamp).getDay();\r\n      let day;\r\n      if (d === 0) {\r\n        day = \"日\";\r\n      } else if (d === 1) {\r\n        day = \"一\";\r\n      } else if (d === 2) {\r\n        day = \"二\";\r\n      } else if (d === 3) {\r\n        day = \"三\";\r\n      } else if (d === 4) {\r\n        day = \"四\";\r\n      } else if (d === 5) {\r\n        day = \"五\";\r\n      } else if (d === 6) {\r\n        day = \"六\";\r\n      }\r\n     return year + \"-\" + month + \"-\" + date+\"   \"+ hh+\":\"+mm+':'+ss+\"   \"+ \"星期\"+day;\r\n}\r\n\r\n\r\n//退出登录\r\nconst logout = () => {\r\n  // 清空登录信息\r\n  localStorage.clear();\r\n  ElNotification({\r\n      title: '温馨提示',\r\n      message: \"已安全退出登录\",\r\n      type: 'success',\r\n      position: \"top-right\"\r\n    })\r\n  // 跳转到登录页面\r\n  router.push(\"login/\");\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.bottom {\r\n  margin-top: 13px;\r\n  line-height: 12px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n.flex-grow {\r\n  flex-grow: 1;\r\n}\r\n</style>","import script from \"./HomeView.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./HomeView.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./HomeView.vue?vue&type=style&index=0&id=4b982d91&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\pycharm\\\\welink\\\\web\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4b982d91\"]])\n\nexport default __exports__"],"names":["refresh","apis","moment_lasted","moment_push","authorize","upload_image_limit","ref","dialogImageUrl","dialogVisible","hideUpload","list_images","percentage","colors","color","uploadUrl","headerObj","Authorization","localStorage","getItem","updateUploadShown","value","length","fileChange","file","resfileList","handleRemove","list","i","uid","splice","handlePictureCardPreview","url","handle_progress_images_upload","console","info","handle_upload_success","response","log","expose","__exports__","obj","reactive","list_picture","computed","item","tmp_list_picture","props","images","push","timestampFormat","timestamp","zeroize","num","String","curTimestamp","parseInt","Date","getTime","toString","timestampDiff","curDate","tmDate","Y","getFullYear","m","getMonth","d","getDate","H","getHours","getMinutes","Math","floor","newDate","update_liked","liked","items","$axios","inject","activeIndex","is_upload_images","image_upload","calculate_is_disabled","data","trim","send","async","btn_type","list_image_upload","forEach","image_path","moment","$const","method","then","resp","currentDate","gmt_created","catch","err","code","unshift","onMounted","load_moments","timer","setInterval","format_datatime","onBeforeUnmount","clearInterval","moments","sort","a","b","x","y","removalDuplicate","ElNotification","title","message","type","position","dataList","byName","result","tem","timeStamp","year","month","date","hh","mm","ss","getSeconds","getDay","day","logout","clear","router"],"sourceRoot":""}